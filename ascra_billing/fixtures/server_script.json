[
 {
  "allow_guest": 1,
  "api_method": "add_voucher",
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Save",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2025-02-17 16:59:06.485647",
  "module": "Ascra Billing",
  "name": "Test",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Website Settings",
  "script": "if frappe.form_dict.message == \"ping\":\r\n\tfrappe.response['message'] = \"pong\"\r\nelse:\r\n\tfrappe.response['message'] = \"ok\"",
  "script_type": "API"
 },
 {
  "allow_guest": 1,
  "api_method": "create_voucher",
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2025-02-17 16:58:59.727988",
  "module": "Ascra Billing",
  "name": "Add Sales Issue Voucher",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": null,
  "script": "# data = \n# try:\n#     frappe.get_doc()",
  "script_type": "API"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Save",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2025-02-17 16:58:42.574924",
  "module": "Ascra Billing",
  "name": "Sales Issue Voucher",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Sales Issue Voucher",
  "script": "if doc.total_amt:\n    total_amt = float(doc.total_amt)\nelse:\n    total_amt = 0\nif doc.tds_amount:\n    tds_amount = float(doc.tds_amount)\nelse:\n    tds_amount = 0\ndoc.net_bill_amt = total_amt + tds_amount\n\ntotal_net_wt = 0\nfor item in doc.item_details:\n    total_net_wt = total_net_wt + float(item.net_wt)\n    \ntotal_row = doc.item_details[-1]\nif total_row.get(\"category\") == \"Total\":\n    doc.item_details.pop()\n    \ndoc.append(\"item_details\", {\n    \"category\": \"Total\",\n    \"net_wt\": total_net_wt,\n    \"peices\": '',\n    \"melting\": '',\n    \"wastage\": '',\n    \"fine\": '',\n    \"other_charges\": ''\n})\n\n\n",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Save",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2025-02-17 16:58:51.454499",
  "module": "Ascra Billing",
  "name": "Sales Receipt Voucher",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Sales Receipt Voucher",
  "script": "if doc.total_amt:\n    total_amt = float(doc.total_amt)\nelse:\n    total_amt = 0\nif doc.tds_amount:\n    tds_amount = float(doc.tds_amount)\nelse:\n    tds_amount = 0\ndoc.net_bill_amt = total_amt + tds_amount",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 1,
  "api_method": "get_address_by_account_code",
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2025-02-17 16:58:35.041880",
  "module": "Ascra Billing",
  "name": "Get Address By Account Code",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": null,
  "script": "acc_code = frappe.form_dict.account_code\nif not frappe.form_dict.account_code:\n    frappe.response['message'] = []\n    \ncust = frappe.db.get_value(\"Customer\", {\"custom_account_code\": acc_code})\n\nif not cust:\n    frappe.response['message'] = []\nelse:\n    add_filter = [[\"Dynamic Link\",\"link_name\",\"=\",cust]]\n    address = [i.get(\"name\") for i in frappe.get_all(\"Address\", add_filter, ['name'])]\n    frappe.response['message'] = address\n",
  "script_type": "API"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Save",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2025-02-17 16:58:27.947312",
  "module": "Ascra Billing",
  "name": "customer_naming_series",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Customer",
  "script": "if not doc.name:\n    if not doc.custom_account_sub_code:\n        custom_account_code=doc.custom_account_code\n        doc.name = f\"{custom_account_code}\"\n    else:\n        doc.name=f\"{custom_account_code}\"+\"-\"+f\"{custom_account_sub_code}\"\n        \n    \n    \n",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Save",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2025-02-17 16:58:19.250800",
  "module": "Ascra Billing",
  "name": "Supplier_naming_series",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Supplier",
  "script": "if not doc.name:\n    if not doc.custom_account_sub_code:\n        custom_account_code=doc.custom_account_code\n        doc.name = f\"{custom_account_code}\"\n    else:\n        doc.name=f\"{custom_account_code}\"+\"-\"+f\"{custom_account_sub_code}\"\n        \n    \n    \n",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 1,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Save",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-09-25 19:08:01.582137",
  "module": null,
  "name": "Address_naming_series",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Address",
  "script": "\nif doc.custom_account_code :\n    custom_account_code=doc.custom_account_code\n    doc.name = f\"{custom_account_code}\"",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "After Insert",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2025-02-17 18:33:25.528934",
  "module": "Ascra Billing",
  "name": "Shipment",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Shipment",
  "script": "if doc.workflow_state == \"Approved\":\n    phone_numbers = frappe.get_all(\n        \"Contact Phone\", \n        filters={\"parent\": doc.delivery_contact_name}, \n        pluck=\"phone\"\n    )\n    \n    phone_numbers_str = \", \".join(phone_numbers) if phone_numbers else \"\"\n    \n    delivery_note = frappe.db.get_value(\"Shipment Delivery Note\",{\"parent\":doc.name},\"delivery_note\")\n    against_sales_invoice = frappe.db.get_value(\"Delivery Note Item\",{\"parent\":delivery_note},\"against_sales_invoice\")\n\n\n    follow_up_doc = frappe.db.get_value(\"Follow-Up\", {\"shipment\": doc.name}, \"name\")\n    \n    if follow_up_doc:\n        existing_doc = frappe.get_doc(\"Follow-Up\", follow_up_doc)\n        existing_doc.append(\"follow_up_detail\", {\n            \"status\": \"Dispatch\",\n            \"remark\": doc.description_of_content,\n            \"next_follow_up_date\": frappe.utils.today(),\n            \"follow_up_by\": doc.pickup_contact_person,\n            \"follow_up_date\": doc.pickup_date\n        })\n        existing_doc.save(ignore_permissions=True)\n        frappe.msgprint(\"Updated existing Follow-Up with new follow-up details.\")\n    \n    else:\n        new_doc = frappe.new_doc(\"Follow-Up\")\n        new_doc.invoice_no = against_sales_invoice if against_sales_invoice else \"\"\n        new_doc.shipment = doc.name\n        new_doc.logistic_remark = doc.description_of_content\n        new_doc.account_name = doc.delivery_customer\n        new_doc.docket_no = doc.shipment_id\n        new_doc.date = doc.pickup_date\n        new_doc.city = frappe.db.get_value(\"Address\", doc.delivery_address_name, \"city\")\n        new_doc.next_follow_by = doc.pickup_contact_person\n        new_doc.next_follow_up = frappe.utils.today()\n        new_doc.section_break_jy8p = \"Dispatch\"\n        \n        new_doc.cargo_purpose = phone_numbers_str\n\n        new_doc.append(\"follow_up_detail\", {\n            \"status\": \"Dispatch\",\n            \"remark\": doc.description_of_content,\n            \"next_follow_up_date\": frappe.utils.today(),\n            \"follow_up_by\": doc.pickup_contact_person,\n            \"follow_up_date\": doc.pickup_date\n        })\n        \n        new_doc.save(ignore_permissions=True)\n        frappe.msgprint(\"Created a new Follow-Up document.\")\n        \n        \n        \n\nif not doc.is_new():\n    doc.append(\"follow_up_detail\", {\n        \"status\": doc.section_break_jy8p,\n        \"remark\": doc.logistic_remark,\n        \"next_follow_up_date\": doc.next_follow_up,\n        \"follow_up_by\": doc.next_follow_by,\n        \"follow_up_date\": doc.next_follow_up\n    })",
  "script_type": "DocType Event"
 }
]